
# STIG: WN11-CC-000326 â€“ PowerShell Script Block Logging must be enabled

### Identifiers
- STIG ID: WN11-CC-000326
- Vuln ID: V-253271 (DISA STIG)

## System / Scope

- **System:** Microsoft Windows 11 Pro 64-bit (Azure virtual machine, x64), standalone
- **Environment:** Azure-hosted virtual machine used for STIG testing
- **Role of system:** User workstation endpoint used for security testing and STIG remediation within a controlled lab environment

## Finding

- PowerShell Script Block Logging was not enabled.
- PowerShell command content was not being captured for audit review.

## Security Impact

- Reduced visibility into PowerShell execution.
- Increased risk of undetected malicious or obfuscated PowerShell activity.
- Limited forensic and incident response capabilities.

## Remediation Performed

- Reviewed the existing PowerShell logging configuration.
- Enabled PowerShell Script Block Logging using a policy-backed registry setting.

## PowerShell Remediation Script

```powershell
# Create the key if it does not exist
New-Item -Path 'HKLM:\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging' -Force | Out-Null

# Enable Script Block Logging
Set-ItemProperty `
  -Path 'HKLM:\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging' `
  -Name 'EnableScriptBlockLogging' `
  -Value 1 `
  -Type DWord
